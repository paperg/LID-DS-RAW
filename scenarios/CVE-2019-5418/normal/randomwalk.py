import sys
import argparse
import urllib.request
from random import randint


def visitSite(site: str):
    link = f"http://{args.server_ip}:3000/{site}"
    urllib.request.urlopen(link)
    if args.verbose:
        print(f"visited: {link}")
    return 1


def randomWalk(sites):
    while True:
        sys.stdin.readline()
        try:
            # choose site
            random_site = randint(0, len(sites) - 1)
            visitSite(sites[random_site])
        except Exception as e:
            if args.verbose:
                print(e)


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='HTTPS-Client Simulation.')

    parser.add_argument('-ip',
                        dest='server_ip',
                        action='store',
                        type=str,
                        required=True,
                        help='The IP address of the target server')
    parser.add_argument('-v',
                        dest='verbose',
                        action='store',
                        type=bool,
                        required=False,
                        default=False,
                        help='Make the operations more talkative')

    args = parser.parse_args()

    sites = [
        'chybeta',
        'site1',
        'site2',
        'site3',
        'site4',
        'site5',
    ]

    randomWalk(sites)
